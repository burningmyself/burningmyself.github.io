
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content=".net,java,php,python,docker,web">
      
      
        <meta name="author" content="BurningMyself">
      
      
        <link rel="canonical" href="https://burningmyself.gitee.io/cloud/kubernetes/kubernetes_velero/">
      
      
        <link rel="prev" href="../kubernetes_gitops/">
      
      
        <link rel="next" href="../kubernetes_kurator/">
      
      <link rel="icon" href="../../../favicon.ico">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.15">
    
    
      
        <title>kubernetes集群备份与恢复管理利器Velero - BurningMyself</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.113286f1.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#kubernetesvelero" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="BurningMyself" class="md-header__button md-logo" aria-label="BurningMyself" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BurningMyself
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              kubernetes集群备份与恢复管理利器Velero
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/burningmyself/burningmyself.github.io" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    burningmyself.github.io
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="BurningMyself" class="md-nav__button md-logo" aria-label="BurningMyself" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    BurningMyself
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/burningmyself/burningmyself.github.io" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    burningmyself.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        介绍
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          技术博文
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          技术博文
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
      
      
      
        <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
          .NET
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          .NET
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../net/c_sharp/" class="md-nav__link">
        C#新特性语法
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../net/c_docker/" class="md-nav__link">
        .Net Core Docker 部署
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../net/c_sqlserver_nginx/" class="md-nav__link">
        Docker 容器化部署 ASP.NET Core
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../net/c_core_safety/" class="md-nav__link">
        让你的ASP.NET Core应用程序更安全
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../net/c_core_study_route/" class="md-nav__link">
        ASP.NET Core开发者指南
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
          Java
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Java
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../java/feature/" class="md-nav__link">
        Java特性
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../java/load-class/" class="md-nav__link">
        Java类加载
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../java/orm/" class="md-nav__link">
        Orm的优缺点
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../java/bio-nio/" class="md-nav__link">
        BIO与NIO
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../java/rocketmq/rmq-1/" class="md-nav__link">
        RocketMq下载与安装
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../java/springAnnotation/" class="md-nav__link">
        Spring常用注解
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../java/javavm/" class="md-nav__link">
        Java 虚拟机
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../java/springdesign/" class="md-nav__link">
        Spring 常用设计
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../java/spring-cloud/" class="md-nav__link">
        Spring Cloud
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../java/java-simple/" class="md-nav__link">
        Java simple
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../java/java-validator/" class="md-nav__link">
        Java Validator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../java/java-string/" class="md-nav__link">
        Java String
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../java/java-utils/" class="md-nav__link">
        Java Utils
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
      
      
      
        <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
          Python
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          Python
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/feature/" class="md-nav__link">
        Python特性
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/str_joint/" class="md-nav__link">
        Python字符拼接
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/syntax_rule/" class="md-nav__link">
        Python语法技巧
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/fabric/" class="md-nav__link">
        远程部署神器 Fabric
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
      
      
      
        <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
          Go
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_4">
          <span class="md-nav__icon md-icon"></span>
          Go
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../go/go_base/" class="md-nav__link">
        Go基础语法
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
      
      
      
        <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
          PHP
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_5">
          <span class="md-nav__icon md-icon"></span>
          PHP
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../php/kj/" class="md-nav__link">
        框架
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
      
      
      
        <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
          Web
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_6">
          <span class="md-nav__icon md-icon"></span>
          Web
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../web/es6/" class="md-nav__link">
        es6语法
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../web/ali_js_style/" class="md-nav__link">
        阿里js样式规范
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../web/node.js/" class="md-nav__link">
        node.js文档
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../web/react/" class="md-nav__link">
        React 开发者指南
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../dart/syntax/" class="md-nav__link">
        Dart语法学习
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../web/react_interview/" class="md-nav__link">
        React 面试
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../web/js_tool_method/" class="md-nav__link">
        js 工具函数
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../web/vue_cp_react/" class="md-nav__link">
        vue与react比较
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../web/javascript/" class="md-nav__link">
        JavaScript 基础
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" >
      
      
      
        <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
          SQL
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_7">
          <span class="md-nav__icon md-icon"></span>
          SQL
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sql/mysql_yh/" class="md-nav__link">
        MySQL优化
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sql/mysql_yh17/" class="md-nav__link">
        MySQL优化
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sql/mysql_log/" class="md-nav__link">
        MySQL日志
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sql/mysql_index/" class="md-nav__link">
        MySQL索引
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sql/mysql_pxc/" class="md-nav__link">
        MySQL PXC集群
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sql/mysql_use/" class="md-nav__link">
        MySQL 数据库应用
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sql/mysql_backups/" class="md-nav__link">
        MySql 备份
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sql/sql_server_master/" class="md-nav__link">
        Sql Server 主从备份
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sql/data_split/" class="md-nav__link">
        数据库之互联网常用分库分表方案
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sql/mybatis/" class="md-nav__link">
        Mybatis使用心德
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8" >
      
      
      
        <label class="md-nav__link" for="__nav_2_8" id="__nav_2_8_label" tabindex="0">
          Linux
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_8">
          <span class="md-nav__icon md-icon"></span>
          Linux
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../linux/linux/" class="md-nav__link">
        Linux学习笔记
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../linux/often/" class="md-nav__link">
        常用命令
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../linux/ope/" class="md-nav__link">
        实用的Linux 命令
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_9" >
      
      
      
        <label class="md-nav__link" for="__nav_2_9" id="__nav_2_9_label" tabindex="0">
          Docker
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_9_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_9">
          <span class="md-nav__icon md-icon"></span>
          Docker
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../docker/docker/" class="md-nav__link">
        Docker全科
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../docker/docker_core/" class="md-nav__link">
        Docker 核心技术
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../docker/docker-compose/" class="md-nav__link">
        docker和docker-compose配置常用环境
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../docker/docker-jenkins/" class="md-nav__link">
        Docker部署Jenkins
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../docker/docker-phabricator/" class="md-nav__link">
        Docker部署Phabricator
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_10" >
      
      
      
        <label class="md-nav__link" for="__nav_2_10" id="__nav_2_10_label" tabindex="0">
          Kubernetes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_10_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_10">
          <span class="md-nav__icon md-icon"></span>
          Kubernetes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../kubernetes/k8s_fw_rule_and_object_design/" class="md-nav__link">
        Kubernetes架构原则和对象设计
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../kubernetes/k8s_etcd/" class="md-nav__link">
        Kubernetes控制平面组件etcd
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../kubernetes/k8s_kube_APIServer/" class="md-nav__link">
        深入理解Kube-APIServer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../kubernetes/k8s_controller_manager/" class="md-nav__link">
        kubernetes控制平面组件
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_11" >
      
      
      
        <label class="md-nav__link" for="__nav_2_11" id="__nav_2_11_label" tabindex="0">
          Tool
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_11_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_11">
          <span class="md-nav__icon md-icon"></span>
          Tool
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tool/git/" class="md-nav__link">
        Git
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tool/gitusual/" class="md-nav__link">
        Git动画展示
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tool/gitquestion/" class="md-nav__link">
        Git问题处理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tool/gitflow/" class="md-nav__link">
        GitFlow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tool/gitbook/" class="md-nav__link">
        GitBook
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tool/gitcmr/" class="md-nav__link">
        Git提交日志规范
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tool/markdown/" class="md-nav__link">
        Markdown
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tool/cicd/" class="md-nav__link">
        CI/CD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tool/mkdocs/" class="md-nav__link">
        mkdocs简单使用
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tool/gitstudy/" class="md-nav__link">
        Git的黑魔法
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tool/minio/" class="md-nav__link">
        MinIO 搭建使用
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tool/cat-monitoring/" class="md-nav__link">
        Cat分布式监控
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          云架构
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          云架构
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../native/" class="md-nav__link">
        云原生
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../virtual/" class="md-nav__link">
        虚拟化技术
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../compute/" class="md-nav__link">
        云计算
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../apprelease/" class="md-nav__link">
        应用部署容器化演进
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../containerlinux/" class="md-nav__link">
        容器技术所涉及Linux内核关键技术
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
      
      
      
        <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
          Docker
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_6">
          <span class="md-nav__icon md-icon"></span>
          Docker
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/docker_native/" class="md-nav__link">
        容器管理工具Docker生态架构及部署
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/docker_nginx/" class="md-nav__link">
        使用容器运行Nginx应用及Docker命令
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/docker_image/" class="md-nav__link">
        Docker容器镜像
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/docker_image_fast/" class="md-nav__link">
        Docker容器镜像加速器及本地容器镜像仓库
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/docker_container_enterprice/" class="md-nav__link">
        Docker容器化部署企业级应用集群
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/docker_file/" class="md-nav__link">
        Dockerfile精讲及新型容器镜像构建技术
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/docker_network/" class="md-nav__link">
        Docker容器网络与通信原理深度解析
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/docker_date/" class="md-nav__link">
        Docker容器数据持久化存储机制
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/docker_compose/" class="md-nav__link">
        Docker容器服务编排利器Docker Compose应用实战
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/docker_swarm/" class="md-nav__link">
        Docker主机集群化方案 Docker Swarm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/docker_devops/" class="md-nav__link">
        基于Docker容器DevOps应用方案 企业业务代码发布系统
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/docker_container/" class="md-nav__link">
        轻量级或工业级容器管理工具
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
          Kubernetes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3_7">
          <span class="md-nav__icon md-icon"></span>
          Kubernetes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        kubeadm极速部署Kubernetes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_introduce/" class="md-nav__link">
        kubernetes介绍与集群架构
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_way/" class="md-nav__link">
        Kubernetes集群部署方式说明
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_master/" class="md-nav__link">
        kubeadm部署单Master节点kubernetes集群
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_hight/" class="md-nav__link">
        kubeadm部署高可用kubernetes集群
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_rke/" class="md-nav__link">
        使用RKE构建企业生产级Kubernetes集群
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_hight_bin1/" class="md-nav__link">
        Kubernetes高可用集群二进制部署（Runtime Docker）
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_hight_bin2/" class="md-nav__link">
        Kubernetes高可用集群二进制部署（Runtime Containerd）
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_ui/" class="md-nav__link">
        Kubernetes集群UI及主机资源监控
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_sealos/" class="md-nav__link">
        使用sealos部署kubernetes集群并实现集群管理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_cluster/" class="md-nav__link">
        kubernetes集群命令语法
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_core/" class="md-nav__link">
        Kubernetes核心概念
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_nginx_ingress_controller/" class="md-nav__link">
        Kubernetes集群 服务暴露 Nginx Ingress Controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_traefik/" class="md-nav__link">
        Kubernetes集群 服务暴露 Traefik
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_configMap_secret/" class="md-nav__link">
        Kubernetes配置与密钥管理 ConfigMap&Secret
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_harbor/" class="md-nav__link">
        Kubernetes集群使用容器镜像仓库Harbor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_safety/" class="md-nav__link">
        Kubernetes集群安全管理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_storage_volume/" class="md-nav__link">
        kubernetes持久化存储卷
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_storage_ceph/" class="md-nav__link">
        kubernetes存储解决方案Ceph
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_cluster_serve/" class="md-nav__link">
        Kubernetes集群公共服务
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_deploy_java/" class="md-nav__link">
        kubernetes集群java项目上云部署
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_deploy_python/" class="md-nav__link">
        kubernetes集群Python项目上云部署
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_deploy_golang/" class="md-nav__link">
        Kubernetes集群golang项目上云部署
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_helm_prometheus/" class="md-nav__link">
        helm部署prometheus监控系统及应用
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_logs_collect/" class="md-nav__link">
        kubernetes日志收集方案ELK
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_zookeeper/" class="md-nav__link">
        企业级中间件上云部署zookeeper
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_kafka/" class="md-nav__link">
        kubernetes云原生中间件上云部署kafka
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_rokectmq/" class="md-nav__link">
        rocketmq部署
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_helm/" class="md-nav__link">
        Kubernetes集群包管理解决方案 Helm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_kustomize/" class="md-nav__link">
        Kubernetes原生配置管理利器 kustomize
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_flannel/" class="md-nav__link">
        kubernetes集群网络解决方案 flannel
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_calico/" class="md-nav__link">
        kubernetes集群网络解决方案 calico
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_hybridnet/" class="md-nav__link">
        kubernetes集群 underlay 网络方案 hybridnet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_ipv4_and_ipv6/" class="md-nav__link">
        kubernetes版本双栈协议（IPv4&IPv6）集群部署
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_rancher/" class="md-nav__link">
        Rancher容器云管理平台
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_kubeconfig/" class="md-nav__link">
        使用kubeconfig管理多集群方法
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_karmada/" class="md-nav__link">
        karmada实现k8s集群联邦
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_kubesphere/" class="md-nav__link">
        安装kubesphere使用
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_ui/" class="md-nav__link">
        阿里云容器服务ACK
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_devops/" class="md-nav__link">
        基于kubernetes集群构建大中型企业CICD应用平台
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_kubesphere_devops/" class="md-nav__link">
        基于KubeSphere实现DevOps
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_gitops/" class="md-nav__link">
        云原生多云持续交付GitOps
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        kubernetes集群备份与恢复管理利器Velero
      </a>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_kurator/" class="md-nav__link">
        kubernetes集群舰队管理Kurator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_openfass/" class="md-nav__link">
        Serverless之OpenFaaS函数即服务
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_flink/" class="md-nav__link">
        Flink基于Kubernetes部署
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_hdfs/" class="md-nav__link">
        大数据HDFS分布式文件系统搭建
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_spark/" class="md-nav__link">
        Spark与Kubernetes整合
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_ui/" class="md-nav__link">
        源监控
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          微服务
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          微服务
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../micro/fbs-lock/" class="md-nav__link">
        分布式锁
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../micro/design/" class="md-nav__link">
        微服务设计
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../micro/distrimsg/" class="md-nav__link">
        分布式系统与消息的投递
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../micro/ddd/" class="md-nav__link">
        基于DDD的微服务设计和开发实战
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../micro/kafka/" class="md-nav__link">
        Kafka架构原理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../micro/redis_cluster/" class="md-nav__link">
        Redis Cluster原理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../micro/spring-cloud-micro/" class="md-nav__link">
        分布式架构
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          经验分析
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          经验分析
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../exp/devops/" class="md-nav__link">
        DevOps
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../exp/micro-service/" class="md-nav__link">
        Micro-Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../exp/raft-gossip/" class="md-nav__link">
        Raft算法和Gossip协议
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../exp/cl/" class="md-nav__link">
        集群和负载均衡
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../exp/ai/" class="md-nav__link">
        人工智能
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../exp/code-principle/" class="md-nav__link">
        代码原则
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../exp/techbig/" class="md-nav__link">
        如何成为技术大牛
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../exp/learnweetout/" class="md-nav__link">
        程序员如何技术成长
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../exp/pt/" class="md-nav__link">
        产品与技术
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../exp/four_deep_learning/" class="md-nav__link">
        深度学习框架
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../exp/tl/" class="md-nav__link">
        在阿里做了5年技术Leader，我总结出这些套路！
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../exp/cto/" class="md-nav__link">
        CTO 技能图谱
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          构架
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          构架
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../framework/split/" class="md-nav__link">
        构架拆分
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../framework/fgb/" class="md-nav__link">
        分布式、高并发、多线程
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../framework/agility/" class="md-nav__link">
        如何理解敏捷开发
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../framework/fwork/" class="md-nav__link">
        走向架构师必备的技能
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../framework/data_middle/" class="md-nav__link">
        数据中台的思考与总结
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../framework/algorithm-ten/" class="md-nav__link">
        必学的 10 大算法
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          情感
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          情感
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../emotion/eq/" class="md-nav__link">
        情商
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../emotion/workheard/" class="md-nav__link">
        工作心得
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../emotion/lookbook/" class="md-nav__link">
        看书
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../emotion/selfdiscipline/" class="md-nav__link">
        自律
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../emotion/livefail/" class="md-nav__link">
        为什么活着失败
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../emotion/emotion/" class="md-nav__link">
        情绪管理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../emotion/losecome/" class="md-nav__link">
        所有的失去，都会以另一种方式归来
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../emotion/threeheart/" class="md-nav__link">
        人生有这三种好心态
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../emotion/onepath/" class="md-nav__link">
        余生，学会一个人走，不管有没有人陪
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../emotion/twopath/" class="md-nav__link">
        往后余生还很精彩，别被熬夜拖垮了
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../emotion/lifetime/" class="md-nav__link">
        心态好的人，一辈子都好
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="kubernetesvelero">kubernetes集群备份与恢复管理利器Velero<a class="headerlink" href="#kubernetesvelero" title="Permanent link">&para;</a></h1>
<h1 id="velero">一、Velero简介<a class="headerlink" href="#velero" title="Permanent link">&para;</a></h1>
<p>Velero 是一款可以安全的备份、恢复和迁移 Kubernetes 集群资源和持久卷等资源的备份恢复软件。</p>
<p>Velero 实现的 kubernetes 资源备份能力，可以轻松实现 Kubernetes 集群的数据备份和恢复、复制 kubernetes 集群资源到其他 kubernetes 集群或者快速复制生产环境到测试环境等功能，这种备份就类似于把资源的 yaml 文件进行整体备份，从而保障资源的完整性。</p>
<p>Velero 对存储的支持较好，可以支持很多种存储资源，比如 AWS S3、Azure Blob、Google Cloud Storage、Alibaba Cloud OSS、Swift、MinIO 等等.</p>
<h1 id="velero_1">二、Velero工作流程<a class="headerlink" href="#velero_1" title="Permanent link">&para;</a></h1>
<p><img alt="img" src="../../../img/kubernetes/kubernetes_velero/16200606_61bb2bae6996764949.png" /></p>
<h1 id="velero_2">三、Velero备份过程<a class="headerlink" href="#velero_2" title="Permanent link">&para;</a></h1>
<ul>
<li>本地 Velero 客户端发送备份指令。</li>
<li>Kubernetes 集群内就会创建一个 Backup 对象。</li>
<li>BackupController 监测 Backup 对象并开始备份过程。</li>
<li>BackupController 会向 API Server 查询相关数据。</li>
<li>BackupController 将查询到的数据备份到远端的对象存储。</li>
</ul>
<h1 id="velero_3">四、Velero特性<a class="headerlink" href="#velero_3" title="Permanent link">&para;</a></h1>
<p>Velero 目前包含以下特性：</p>
<ul>
<li>支持 Kubernetes 集群数据备份和恢复</li>
<li>支持复制当前 Kubernetes 集群的资源到其它 Kubernetes 集群</li>
<li>支持复制生产环境到开发以及测试环境</li>
</ul>
<h1 id="velero_4">五、Velero组件<a class="headerlink" href="#velero_4" title="Permanent link">&para;</a></h1>
<p>Velero 组件一共分两部分，分别是服务端和客户端。</p>
<ul>
<li>服务端：运行在你 Kubernetes 的集群中</li>
<li>客户端：是一些运行在本地的命令行的工具，需要已配置好 kubectl 及集群 kubeconfig 的机器上</li>
</ul>
<h1 id="velero_5">六、Velero支持备份存储<a class="headerlink" href="#velero_5" title="Permanent link">&para;</a></h1>
<ul>
<li>AWS S3 以及兼容 S3 的存储，比如：Minio</li>
<li>Azure BloB 存储</li>
<li>Google Cloud 存储</li>
<li>阿里云OSS</li>
</ul>
<h1 id="velero_6">七、Velero适用场景<a class="headerlink" href="#velero_6" title="Permanent link">&para;</a></h1>
<ul>
<li>灾备场景：提供备份恢复k8s集群的能力</li>
<li>迁移场景：提供拷贝集群资源到其他集群的能力（复制同步开发，测试，生产环境的集群配置，简化环境配置）</li>
</ul>
<h1 id="veleroetcd">八、Velero备份与etcd备份的区别<a class="headerlink" href="#veleroetcd" title="Permanent link">&para;</a></h1>
<ul>
<li>与 Etcd 备份相比，直接备份 Etcd 是将集群的全部资源备份起来。</li>
<li>Velero 可以对 Kubernetes 集群内对象级别进行备份。</li>
<li>除了对 Kubernetes 集群进行整体备份外，Velero 还可以通过对 Type、Namespace、Label 等对象进行分类备份或者恢复。</li>
</ul>
<blockquote>
<p>注意：备份过程中创建的对象是不会被备份的。</p>
</blockquote>
<h1 id="velero_7">九、Velero部署<a class="headerlink" href="#velero_7" title="Permanent link">&para;</a></h1>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Velero version</td>
<td>Expected Kubernetes version compatibility</td>
<td>Tested on Kubernetes version</td>
</tr>
<tr>
<td>1.11</td>
<td>1.18-latest</td>
<td>1.23.10, 1.24.9, 1.25.5, and 1.26.1</td>
</tr>
<tr>
<td>1.10</td>
<td>1.18-latest</td>
<td>1.22.5, 1.23.8, 1.24.6 and 1.25.1</td>
</tr>
<tr>
<td>1.9</td>
<td>1.18-latest</td>
<td>1.20.5, 1.21.2, 1.22.5, 1.23, and 1.24</td>
</tr>
<tr>
<td>1.8</td>
<td>1.18-latest</td>
<td></td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># kubectl get nodes</span>
<span class="n">NAME</span>           <span class="n">STATUS</span>   <span class="n">ROLES</span>           <span class="n">AGE</span>   <span class="n">VERSION</span>
<span class="n">k8s-master01</span>   <span class="n">Ready</span>    <span class="n">control-plane</span>   <span class="n">55d</span>   <span class="n">v1</span><span class="p">.</span><span class="n">25</span><span class="p">.</span><span class="n">0</span>
<span class="n">k8s-worker01</span>   <span class="n">Ready</span>    <span class="p">&lt;</span><span class="n">none</span><span class="p">&gt;</span>          <span class="n">55d</span>   <span class="n">v1</span><span class="p">.</span><span class="n">25</span><span class="p">.</span><span class="n">0</span>
<span class="n">k8s-worker02</span>   <span class="n">Ready</span>    <span class="p">&lt;</span><span class="n">none</span><span class="p">&gt;</span>          <span class="n">55d</span>   <span class="n">v1</span><span class="p">.</span><span class="n">25</span><span class="p">.</span><span class="n">0</span>
</code></pre></div>
<h2 id="91_velero">9.1 Velero工具获取<a class="headerlink" href="#91_velero" title="Permanent link">&para;</a></h2>
<p><img alt="image-20230607153118915" src="../../../img/kubernetes/kubernetes_velero/image-20230607153118915.png" /></p>
<p><img alt="image-20230607153146246" src="../../../img/kubernetes/kubernetes_velero/image-20230607153146246.png" /></p>
<p><img alt="image-20230607153425305" src="../../../img/kubernetes/kubernetes_velero/image-20230607153425305.png" /></p>
<p><img alt="image-20230607153540407" src="../../../img/kubernetes/kubernetes_velero/image-20230607153540407.png" /></p>
<p><img alt="image-20230607153639779" src="../../../img/kubernetes/kubernetes_velero/image-20230607153639779.png" /></p>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># wget https://github.com/vmware-tanzu/velero/releases/download/v1.11.0/velero-v1.11.0-linux-amd64.tar.gz</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># ls</span>
<span class="n">velero-v1</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">0-linux-amd64</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span>
</code></pre></div>
<h2 id="92_velerominio">9.2 部署Velero依赖后端存储MinIo<a class="headerlink" href="#92_velerominio" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># tar xf velero-v1.11.0-linux-amd64.tar.gz</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># ls</span>
<span class="n">velero-v1</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">0-linux-amd64</span> 

<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># cd velero-v1.11.0-linux-amd64/</span>

<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">velero-v1</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">0-linux-amd64</span><span class="p">]</span><span class="c"># ls</span>
<span class="n">examples</span>  <span class="n">LICENSE</span>  <span class="n">velero</span>

<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">velero-v1</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">0-linux-amd64</span><span class="p">]</span><span class="c"># cd examples/</span>

<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">examples</span><span class="p">]</span><span class="c"># ls</span>
<span class="n">minio</span>  <span class="n">nginx-app</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">examples</span><span class="p">]</span><span class="c"># cd minio/</span>
<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">minio</span><span class="p">]</span><span class="c"># ls</span>
<span class="n">00-minio-deployment</span><span class="p">.</span><span class="n">yaml</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">minio</span><span class="p">]</span><span class="c"># vim 00-minio-deployment.yaml</span>

<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">minio</span><span class="p">]</span><span class="c"># cat 00-minio-deployment.yaml</span>
<span class="c"># Copyright 2017 the Velero contributors.</span>
<span class="c">#</span>
<span class="c"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c"># you may not use this file except in compliance with the License.</span>
<span class="c"># You may obtain a copy of the License at</span>
<span class="c">#</span>
<span class="c">#     http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c">#</span>
<span class="c"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c"># See the License for the specific language governing permissions and</span>
<span class="c"># limitations under the License.</span>

<span class="p">---</span>
<span class="n">apiVersion</span><span class="p">:</span> <span class="n">v1</span>
<span class="n">kind</span><span class="p">:</span> <span class="n">Namespace</span>
<span class="n">metadata</span><span class="p">:</span>
  <span class="n">name</span><span class="p">:</span> <span class="n">velero</span>

<span class="p">---</span>
<span class="n">apiVersion</span><span class="p">:</span> <span class="n">apps</span><span class="p">/</span><span class="n">v1</span>
<span class="n">kind</span><span class="p">:</span> <span class="n">Deployment</span>
<span class="n">metadata</span><span class="p">:</span>
  <span class="n">namespace</span><span class="p">:</span> <span class="n">velero</span>
  <span class="n">name</span><span class="p">:</span> <span class="n">minio</span>
  <span class="n">labels</span><span class="p">:</span>
    <span class="n">component</span><span class="p">:</span> <span class="n">minio</span>
<span class="n">spec</span><span class="p">:</span>
  <span class="n">strategy</span><span class="p">:</span>
    <span class="n">type</span><span class="p">:</span> <span class="n">Recreate</span>
  <span class="n">selector</span><span class="p">:</span>
    <span class="n">matchLabels</span><span class="p">:</span>
      <span class="n">component</span><span class="p">:</span> <span class="n">minio</span>
  <span class="n">template</span><span class="p">:</span>
    <span class="n">metadata</span><span class="p">:</span>
      <span class="n">labels</span><span class="p">:</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">minio</span>
    <span class="n">spec</span><span class="p">:</span>
      <span class="n">volumes</span><span class="p">:</span>
      <span class="p">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">storage</span>
        <span class="n">emptyDir</span><span class="p">:</span> <span class="p">{}</span>
      <span class="p">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">config</span>
        <span class="n">emptyDir</span><span class="p">:</span> <span class="p">{}</span>
      <span class="n">containers</span><span class="p">:</span>
      <span class="p">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">minio</span>
        <span class="n">image</span><span class="p">:</span> <span class="n">minio</span><span class="p">/</span><span class="n">minio</span><span class="p">:</span><span class="n">latest</span>
        <span class="n">imagePullPolicy</span><span class="p">:</span> <span class="n">IfNotPresent</span>
        <span class="n">args</span><span class="p">:</span>
        <span class="p">-</span> <span class="n">server</span>
        <span class="p">-</span> <span class="p">/</span><span class="n">storage</span>
        <span class="p">-</span> <span class="p">-</span><span class="n">-config-dir</span><span class="p">=/</span><span class="n">config</span>
        <span class="p">-</span> <span class="p">-</span><span class="n">-console-address</span>
        <span class="p">-</span> <span class="s2">&quot;:30605&quot;</span>
        <span class="n">env</span><span class="p">:</span>
        <span class="p">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">MINIO_ACCESS_KEY</span>
          <span class="n">value</span><span class="p">:</span> <span class="s2">&quot;minio&quot;</span>
        <span class="p">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">MINIO_SECRET_KEY</span>
          <span class="n">value</span><span class="p">:</span> <span class="s2">&quot;minio123&quot;</span>
        <span class="n">ports</span><span class="p">:</span>
        <span class="p">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">web</span>
          <span class="n">containerPort</span><span class="p">:</span> <span class="n">9000</span>
        <span class="p">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">console</span>
          <span class="n">containerPort</span><span class="p">:</span> <span class="n">30605</span>
        <span class="n">volumeMounts</span><span class="p">:</span>
        <span class="p">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">storage</span>
          <span class="n">mountPath</span><span class="p">:</span> <span class="s2">&quot;/storage&quot;</span>
        <span class="p">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">config</span>
          <span class="n">mountPath</span><span class="p">:</span> <span class="s2">&quot;/config&quot;</span>

<span class="p">---</span>
<span class="n">apiVersion</span><span class="p">:</span> <span class="n">v1</span>
<span class="n">kind</span><span class="p">:</span> <span class="n">Service</span>
<span class="n">metadata</span><span class="p">:</span>
  <span class="n">namespace</span><span class="p">:</span> <span class="n">velero</span>
  <span class="n">name</span><span class="p">:</span> <span class="n">minio</span>
  <span class="n">labels</span><span class="p">:</span>
    <span class="n">component</span><span class="p">:</span> <span class="n">minio</span>
<span class="n">spec</span><span class="p">:</span>
  <span class="c"># ClusterIP is recommended for production environments.</span>
  <span class="c"># Change to NodePort if needed per documentation,</span>
  <span class="c"># but only if you run Minio in a test/trial environment, for example with Minikube.</span>
  <span class="n">type</span><span class="p">:</span> <span class="n">NodePort</span>
  <span class="n">ports</span><span class="p">:</span>
    <span class="p">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">web</span>
      <span class="n">port</span><span class="p">:</span> <span class="n">9000</span>
      <span class="n">targetPort</span><span class="p">:</span> <span class="n">9000</span>
      <span class="n">nodePort</span><span class="p">:</span> <span class="n">31900</span>
      <span class="n">protocol</span><span class="p">:</span> <span class="n">TCP</span>
    <span class="p">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">console</span>
      <span class="n">port</span><span class="p">:</span> <span class="n">30605</span>
      <span class="n">targetPort</span><span class="p">:</span> <span class="n">30605</span>
      <span class="n">nodePort</span><span class="p">:</span> <span class="n">30605</span>
      <span class="n">protocol</span><span class="p">:</span> <span class="n">TCP</span>
  <span class="n">selector</span><span class="p">:</span>
    <span class="n">component</span><span class="p">:</span> <span class="n">minio</span>

<span class="p">---</span>
<span class="n">apiVersion</span><span class="p">:</span> <span class="n">batch</span><span class="p">/</span><span class="n">v1</span>
<span class="n">kind</span><span class="p">:</span> <span class="n">Job</span>
<span class="n">metadata</span><span class="p">:</span>
  <span class="n">namespace</span><span class="p">:</span> <span class="n">velero</span>
  <span class="n">name</span><span class="p">:</span> <span class="n">minio-setup</span>
  <span class="n">labels</span><span class="p">:</span>
    <span class="n">component</span><span class="p">:</span> <span class="n">minio</span>
<span class="n">spec</span><span class="p">:</span>
  <span class="n">template</span><span class="p">:</span>
    <span class="n">metadata</span><span class="p">:</span>
      <span class="n">name</span><span class="p">:</span> <span class="n">minio-setup</span>
    <span class="n">spec</span><span class="p">:</span>
      <span class="n">restartPolicy</span><span class="p">:</span> <span class="n">OnFailure</span>
      <span class="n">volumes</span><span class="p">:</span>
      <span class="p">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">config</span>
        <span class="n">emptyDir</span><span class="p">:</span> <span class="p">{}</span>
      <span class="n">containers</span><span class="p">:</span>
      <span class="p">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">mc</span>
        <span class="n">image</span><span class="p">:</span> <span class="n">minio</span><span class="p">/</span><span class="n">mc</span><span class="p">:</span><span class="n">latest</span>
        <span class="n">imagePullPolicy</span><span class="p">:</span> <span class="n">IfNotPresent</span>
        <span class="n">command</span><span class="p">:</span>
        <span class="p">-</span> <span class="p">/</span><span class="n">bin</span><span class="p">/</span><span class="n">sh</span>
        <span class="p">-</span> <span class="n">-c</span>
        <span class="p">-</span> <span class="s2">&quot;mc --config-dir=/config config host add velero http://minio:9000 minio minio123 &amp;&amp; mc --config-dir=/config mb -p velero/velero&quot;</span>
        <span class="n">volumeMounts</span><span class="p">:</span>
        <span class="p">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">config</span>
          <span class="n">mountPath</span><span class="p">:</span> <span class="s2">&quot;/config&quot;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">minio</span><span class="p">]</span><span class="c"># pwd</span>
<span class="p">/</span><span class="n">root</span><span class="p">/</span><span class="n">velero-v1</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">0-linux-amd64</span><span class="p">/</span><span class="n">examples</span><span class="p">/</span><span class="n">minio</span>

<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">minio</span><span class="p">]</span><span class="c"># ls</span>
<span class="n">00-minio-deployment</span><span class="p">.</span><span class="n">yaml</span>

<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">minio</span><span class="p">]</span><span class="c"># kubectl apply -f 00-minio-deployment.yaml</span>
<span class="n">namespace</span><span class="p">/</span><span class="n">velero</span> <span class="n">created</span>
<span class="n">deployment</span><span class="p">.</span><span class="n">apps</span><span class="p">/</span><span class="n">minio</span> <span class="n">created</span>
<span class="n">service</span><span class="p">/</span><span class="n">minio</span> <span class="n">created</span>
<span class="n">job</span><span class="p">.</span><span class="n">batch</span><span class="p">/</span><span class="n">minio-setup</span> <span class="n">created</span>
</code></pre></div>
<blockquote>
<p>注意：访问用户名为minio，密码为minio123</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">minio</span><span class="p">]</span><span class="c"># kubectl get all -n velero</span>
<span class="n">NAME</span>                         <span class="n">READY</span>   <span class="n">STATUS</span>      <span class="n">RESTARTS</span>   <span class="n">AGE</span>
<span class="n">pod</span><span class="p">/</span><span class="n">minio</span><span class="p">-</span><span class="n">6959795f76-fc4ls</span>   <span class="n">1</span><span class="p">/</span><span class="n">1</span>     <span class="n">Running</span>     <span class="n">0</span>          <span class="n">2m52s</span>
<span class="n">pod</span><span class="p">/</span><span class="n">minio-setup-fsfvm</span>        <span class="n">0</span><span class="p">/</span><span class="n">1</span>     <span class="n">Completed</span>   <span class="n">0</span>          <span class="n">2m51s</span>

<span class="n">NAME</span>            <span class="nb">TYPE </span>      <span class="n">CLUSTER-IP</span>   <span class="n">EXTERNAL-IP</span>   <span class="n">PORT</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>                          <span class="n">AGE</span>
<span class="n">service</span><span class="p">/</span><span class="n">minio</span>   <span class="n">NodePort</span>   <span class="n">10</span><span class="p">.</span><span class="n">96</span><span class="p">.</span><span class="n">2</span><span class="p">.</span><span class="n">7</span>    <span class="p">&lt;</span><span class="n">none</span><span class="p">&gt;</span>        <span class="n">9000</span><span class="p">:</span><span class="n">31900</span><span class="p">/</span><span class="n">TCP</span><span class="p">,</span><span class="n">30605</span><span class="p">:</span><span class="n">30605</span><span class="p">/</span><span class="n">TCP</span>   <span class="n">2m52s</span>

<span class="n">NAME</span>                    <span class="n">READY</span>   <span class="n">UP-TO-DATE</span>   <span class="n">AVAILABLE</span>   <span class="n">AGE</span>
<span class="n">deployment</span><span class="p">.</span><span class="n">apps</span><span class="p">/</span><span class="n">minio</span>   <span class="n">1</span><span class="p">/</span><span class="n">1</span>     <span class="n">1</span>            <span class="n">1</span>           <span class="n">2m52s</span>

<span class="n">NAME</span>                               <span class="n">DESIRED</span>   <span class="n">CURRENT</span>   <span class="n">READY</span>   <span class="n">AGE</span>
<span class="n">replicaset</span><span class="p">.</span><span class="n">apps</span><span class="p">/</span><span class="n">minio</span><span class="p">-</span><span class="n">6959795f76</span>   <span class="n">1</span>         <span class="n">1</span>         <span class="n">1</span>       <span class="n">2m52s</span>

<span class="n">NAME</span>                    <span class="n">COMPLETIONS</span>   <span class="n">DURATION</span>   <span class="n">AGE</span>
<span class="n">job</span><span class="p">.</span><span class="n">batch</span><span class="p">/</span><span class="n">minio-setup</span>   <span class="n">1</span><span class="p">/</span><span class="n">1</span>           <span class="n">4s</span>         <span class="n">2m52s</span>
</code></pre></div>
<p><img alt="image-20230607173840236" src="../../../img/kubernetes/kubernetes_velero/image-20230607173840236.png" /></p>
<p><img alt="image-20230607173939822" src="../../../img/kubernetes/kubernetes_velero/image-20230607173939822.png" /></p>
<p><img alt="image-20230607174053103" src="../../../img/kubernetes/kubernetes_velero/image-20230607174053103.png" /></p>
<h2 id="93_velero">9.3 安装Velero<a class="headerlink" href="#93_velero" title="Permanent link">&para;</a></h2>
<h3 id="931_minio">9.3.1 创建访问minio密钥<a class="headerlink" href="#931_minio" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">velero-v1</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">0-linux-amd64</span><span class="p">]</span><span class="c"># vim cred-velero</span>
<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">velero-v1</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">0-linux-amd64</span><span class="p">]</span><span class="c"># cat cred-velero</span>
<span class="no">[default]</span>
<span class="n">aws_access_key_id</span> <span class="p">=</span> <span class="n">minio</span>
<span class="n">aws_secret_access_key</span> <span class="p">=</span> <span class="n">minio123</span>
</code></pre></div>
<p>或</p>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">velero-v1</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">0-linux-amd64</span><span class="p">]</span><span class="c"># cat &gt; cred-velero &lt;&lt; EOF</span>
<span class="no">[default]</span>
<span class="n">aws_access_key_id</span> <span class="p">=</span> <span class="n">minio</span>
<span class="n">aws_secret_access_key</span> <span class="p">=</span> <span class="n">minio123</span>
<span class="n">EOF</span>
</code></pre></div>
<h3 id="932_velero">9.3.2 安装Velero客户端到当前系统<a class="headerlink" href="#932_velero" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">velero-v1</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">0-linux-amd64</span><span class="p">]</span><span class="c"># pwd</span>
<span class="p">/</span><span class="n">root</span><span class="p">/</span><span class="n">velero-v1</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">0-linux-amd64</span>
<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">velero-v1</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">0-linux-amd64</span><span class="p">]</span><span class="c"># ls</span>
<span class="n">examples</span>  <span class="n">LICENSE</span>  <span class="n">velero</span>
<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">velero-v1</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">0-linux-amd64</span><span class="p">]</span><span class="c"># cp velero /usr/bin/</span>
<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">velero-v1</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">0-linux-amd64</span><span class="p">]</span><span class="c"># ls /usr/bin/velero</span>
<span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">bin</span><span class="p">/</span><span class="n">velero</span>
</code></pre></div>
<h3 id="933_k8svelero">9.3.3 在K8S集群快速安装Velero<a class="headerlink" href="#933_k8svelero" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># velero completion bash</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># dig -t a minio.velero.svc.cluster.local. @10.96.0.10</span>

<span class="p">;</span> <span class="p">&lt;&lt;&gt;&gt;</span> <span class="n">DiG</span> <span class="n">9</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">4-P2-RedHat</span><span class="p">-</span><span class="n">9</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">4</span><span class="p">-</span><span class="n">26</span><span class="p">.</span><span class="n">P2</span><span class="p">.</span><span class="n">el7_9</span><span class="p">.</span><span class="n">9</span> <span class="p">&lt;&lt;&gt;&gt;</span> <span class="n">-t</span> <span class="n">a</span> <span class="n">minio</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">svc</span><span class="p">.</span><span class="n">cluster</span><span class="p">.</span><span class="n">local</span><span class="p">.</span> <span class="nv">@10</span><span class="p">.</span><span class="n">96</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">10</span>
<span class="p">;;</span> <span class="n">global</span> <span class="n">options</span><span class="p">:</span> <span class="p">+</span><span class="n">cmd</span>
<span class="p">;;</span> <span class="n">Got</span> <span class="n">answer</span><span class="p">:</span>
<span class="p">;;</span> <span class="n">WARNING</span><span class="p">:</span> <span class="p">.</span><span class="n">local</span> <span class="n">is</span> <span class="n">reserved</span> <span class="k">for</span> <span class="n">Multicast</span> <span class="n">DNS</span>
<span class="p">;;</span> <span class="n">You</span> <span class="n">are</span> <span class="n">currently</span> <span class="n">testing</span> <span class="n">what</span> <span class="n">happens</span> <span class="n">when</span> <span class="n">an</span> <span class="n">mDNS</span> <span class="n">query</span> <span class="n">is</span> <span class="n">leaked</span> <span class="n">to</span> <span class="n">DNS</span>
<span class="p">;;</span> <span class="p">-&gt;&gt;</span><span class="n">HEADER</span><span class="p">&lt;&lt;-</span> <span class="n">opcode</span><span class="p">:</span> <span class="n">QUERY</span><span class="p">,</span> <span class="n">status</span><span class="p">:</span> <span class="n">NOERROR</span><span class="p">,</span> <span class="n">id</span><span class="p">:</span> <span class="n">43950</span>
<span class="p">;;</span> <span class="n">flags</span><span class="p">:</span> <span class="n">qr</span> <span class="n">aa</span> <span class="n">rd</span><span class="p">;</span> <span class="n">QUERY</span><span class="p">:</span> <span class="n">1</span><span class="p">,</span> <span class="n">ANSWER</span><span class="p">:</span> <span class="n">1</span><span class="p">,</span> <span class="n">AUTHORITY</span><span class="p">:</span> <span class="n">0</span><span class="p">,</span> <span class="n">ADDITIONAL</span><span class="p">:</span> <span class="n">1</span>
<span class="p">;;</span> <span class="n">WARNING</span><span class="p">:</span> <span class="n">recursion</span> <span class="n">requested</span> <span class="n">but</span> <span class="n">not</span> <span class="n">available</span>

<span class="p">;;</span> <span class="n">OPT</span> <span class="n">PSEUDOSECTION</span><span class="p">:</span>
<span class="p">;</span> <span class="n">EDNS</span><span class="p">:</span> <span class="n">version</span><span class="p">:</span> <span class="n">0</span><span class="p">,</span> <span class="n">flags</span><span class="p">:;</span> <span class="n">udp</span><span class="p">:</span> <span class="n">4096</span>
<span class="p">;;</span> <span class="n">QUESTION</span> <span class="n">SECTION</span><span class="p">:</span>
<span class="p">;</span><span class="n">minio</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">svc</span><span class="p">.</span><span class="n">cluster</span><span class="p">.</span><span class="n">local</span><span class="p">.</span>        <span class="k">IN</span>      <span class="n">A</span>

<span class="p">;;</span> <span class="n">ANSWER</span> <span class="n">SECTION</span><span class="p">:</span>
<span class="n">minio</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">svc</span><span class="p">.</span><span class="n">cluster</span><span class="p">.</span><span class="n">local</span><span class="p">.</span> <span class="n">30</span> <span class="k">IN</span>   <span class="n">A</span>       <span class="n">10</span><span class="p">.</span><span class="n">96</span><span class="p">.</span><span class="n">2</span><span class="p">.</span><span class="n">7</span>

<span class="p">;;</span> <span class="n">Query</span> <span class="n">time</span><span class="p">:</span> <span class="n">0</span> <span class="n">msec</span>
<span class="p">;;</span> <span class="n">SERVER</span><span class="p">:</span> <span class="n">10</span><span class="p">.</span><span class="n">96</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">10</span><span class="c">#53(10.96.0.10)</span>
<span class="p">;;</span> <span class="n">WHEN</span><span class="p">:</span> <span class="n">三</span> <span class="n">6月</span> <span class="n">07</span> <span class="n">18</span><span class="p">:</span><span class="n">06</span><span class="p">:</span><span class="n">18</span> <span class="n">CST</span> <span class="n">2023</span>
<span class="p">;;</span> <span class="n">MSG</span> <span class="n">SIZE</span>  <span class="n">rcvd</span><span class="p">:</span> <span class="n">105</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">velero-v1</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">0-linux-amd64</span><span class="p">]</span><span class="c"># ls</span>
<span class="n">cred-velero</span>  <span class="n">examples</span>  <span class="n">LICENSE</span>  <span class="n">velero</span>  <span class="n">velero</span><span class="p">.</span><span class="n">sh</span>
<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">velero-v1</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">0-linux-amd64</span><span class="p">]</span><span class="c"># vim velero.sh</span>
<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">velero-v1</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">0-linux-amd64</span><span class="p">]</span><span class="c"># cat velero.sh</span>
<span class="n">velero</span> <span class="n">install</span> <span class="p">\</span>
     <span class="p">-</span><span class="n">-provider</span> <span class="n">aws</span> <span class="p">\</span>
     <span class="p">-</span><span class="n">-plugins</span> <span class="n">velero</span><span class="p">/</span><span class="n">velero-plugin-for-aws</span><span class="p">:</span><span class="n">v1</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span> <span class="p">\</span>
     <span class="p">-</span><span class="n">-bucket</span> <span class="n">velero</span> <span class="p">\</span>
     <span class="p">-</span><span class="n">-secret</span><span class="o">-file</span> <span class="p">./</span><span class="n">cred-velero</span> <span class="p">\</span>
     <span class="p">-</span><span class="n">-use-volume-snapshots</span><span class="p">=</span><span class="n">false</span> <span class="p">\</span>
     <span class="p">-</span><span class="n">-backup-location-config</span> <span class="n">region</span><span class="p">=</span><span class="n">minio</span><span class="p">,</span><span class="n">s3ForcePathStyle</span><span class="p">=</span><span class="s2">&quot;true&quot;</span><span class="p">,</span><span class="n">s3Url</span><span class="p">=</span><span class="n">http</span><span class="p">://</span><span class="n">minio</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">svc</span><span class="p">.</span><span class="n">cluster</span><span class="p">.</span><span class="n">local</span><span class="p">.:</span><span class="n">9000</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">velero-v1</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">0-linux-amd64</span><span class="p">]</span><span class="c"># sh velero.sh</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">backuprepositories</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">backuprepositories</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">backuprepositories</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">created</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">backups</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">backups</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">backups</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">created</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">backupstoragelocations</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">backupstoragelocations</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">backupstoragelocations</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">created</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">deletebackuprequests</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">deletebackuprequests</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">deletebackuprequests</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">created</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">downloadrequests</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">downloadrequests</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">downloadrequests</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">created</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">podvolumebackups</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">podvolumebackups</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">podvolumebackups</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">created</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">podvolumerestores</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">podvolumerestores</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">podvolumerestores</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">created</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">restores</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">restores</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">restores</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">created</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">schedules</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">schedules</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">schedules</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">created</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">serverstatusrequests</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">serverstatusrequests</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">serverstatusrequests</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">created</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">volumesnapshotlocations</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">volumesnapshotlocations</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">volumesnapshotlocations</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">created</span>
<span class="n">Waiting</span> <span class="k">for</span> <span class="n">resources</span> <span class="n">to</span> <span class="n">be</span> <span class="n">ready</span> <span class="k">in</span> <span class="n">cluster</span><span class="p">...</span>
<span class="n">Namespace</span><span class="p">/</span><span class="n">velero</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">Namespace</span><span class="p">/</span><span class="n">velero</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">Namespace</span><span class="p">/</span><span class="n">velero</span><span class="p">:</span> <span class="n">already</span> <span class="n">exists</span><span class="p">,</span> <span class="n">proceeding</span>
<span class="n">Namespace</span><span class="p">/</span><span class="n">velero</span><span class="p">:</span> <span class="n">created</span>
<span class="n">ClusterRoleBinding</span><span class="p">/</span><span class="n">velero</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">ClusterRoleBinding</span><span class="p">/</span><span class="n">velero</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">ClusterRoleBinding</span><span class="p">/</span><span class="n">velero</span><span class="p">:</span> <span class="n">created</span>
<span class="n">ServiceAccount</span><span class="p">/</span><span class="n">velero</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">ServiceAccount</span><span class="p">/</span><span class="n">velero</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">ServiceAccount</span><span class="p">/</span><span class="n">velero</span><span class="p">:</span> <span class="n">created</span>
<span class="n">Secret</span><span class="p">/</span><span class="n">cloud-credentials</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">Secret</span><span class="p">/</span><span class="n">cloud-credentials</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">Secret</span><span class="p">/</span><span class="n">cloud-credentials</span><span class="p">:</span> <span class="n">created</span>
<span class="n">BackupStorageLocation</span><span class="p">/</span><span class="k">default</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">BackupStorageLocation</span><span class="p">/</span><span class="k">default</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">BackupStorageLocation</span><span class="p">/</span><span class="k">default</span><span class="p">:</span> <span class="n">created</span>
<span class="n">Deployment</span><span class="p">/</span><span class="n">velero</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">Deployment</span><span class="p">/</span><span class="n">velero</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">Deployment</span><span class="p">/</span><span class="n">velero</span><span class="p">:</span> <span class="n">created</span>
<span class="n">Velero</span> <span class="n">is</span> <span class="n">installed</span><span class="p">!</span> <span class="err">⛵</span> <span class="n">Use</span> <span class="s1">&#39;kubectl logs deployment/velero -n velero&#39;</span> <span class="n">to</span> <span class="n">view</span> <span class="n">the</span> <span class="n">status</span><span class="p">.</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">velero-v1</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">0-linux-amd64</span><span class="p">]</span><span class="c"># kubectl api-versions | grep velero</span>
<span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">/</span><span class="n">v1</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">velero-v1</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">0-linux-amd64</span><span class="p">]</span><span class="c"># kubectl get pods -n velero</span>
<span class="n">NAME</span>                      <span class="n">READY</span>   <span class="n">STATUS</span>      <span class="n">RESTARTS</span>   <span class="n">AGE</span>
<span class="n">minio</span><span class="p">-</span><span class="n">6959795f76-fc4ls</span>    <span class="n">1</span><span class="p">/</span><span class="n">1</span>     <span class="n">Running</span>     <span class="n">0</span>          <span class="n">38m</span>
<span class="n">minio-setup-fsfvm</span>         <span class="n">0</span><span class="p">/</span><span class="n">1</span>     <span class="n">Completed</span>   <span class="n">0</span>          <span class="n">38m</span>
<span class="n">velero</span><span class="p">-</span><span class="n">84fff5d559-rr6bw</span>   <span class="n">1</span><span class="p">/</span><span class="n">1</span>     <span class="n">Running</span>     <span class="n">0</span>          <span class="n">93s</span>
</code></pre></div>
<h1 id="velero_8">十、velero命令介绍<a class="headerlink" href="#velero_8" title="Permanent link">&para;</a></h1>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># velero create backup --help</span>
<span class="n">Create</span> <span class="n">a</span> <span class="n">backup</span>

<span class="n">Usage</span><span class="p">:</span>
  <span class="n">velero</span> <span class="n">create</span> <span class="n">backup</span> <span class="n">NAME</span> <span class="no">[flags]</span>

<span class="n">Examples</span><span class="p">:</span>
  <span class="c"># Create a backup containing all resources.</span>
  <span class="n">velero</span> <span class="n">backup</span> <span class="n">create</span> <span class="n">backup1</span>

  <span class="c"># Create a backup including only the nginx namespace.</span>
  <span class="n">velero</span> <span class="n">backup</span> <span class="n">create</span> <span class="n">nginx-backup</span> <span class="p">-</span><span class="n">-include-namespaces</span> <span class="n">nginx</span>

  <span class="c"># Create a backup excluding the velero and default namespaces.</span>
  <span class="n">velero</span> <span class="n">backup</span> <span class="n">create</span> <span class="n">backup2</span> <span class="p">-</span><span class="n">-exclude-namespaces</span> <span class="n">velero</span><span class="p">,</span><span class="k">default</span>

  <span class="c"># Create a backup based on a schedule named daily-backup.</span>
  <span class="n">velero</span> <span class="n">backup</span> <span class="n">create</span> <span class="p">-</span><span class="n">-from-schedule</span> <span class="n">daily-backup</span>

  <span class="c"># View the YAML for a backup that doesn&#39;t snapshot volumes, without sending it to the server.</span>
  <span class="n">velero</span> <span class="n">backup</span> <span class="n">create</span> <span class="n">backup3</span> <span class="p">-</span><span class="n">-snapshot-volumes</span><span class="p">=</span><span class="n">false</span> <span class="n">-o</span> <span class="n">yaml</span>

  <span class="c"># Wait for a backup to complete before returning from the command.</span>
  <span class="n">velero</span> <span class="n">backup</span> <span class="n">create</span> <span class="n">backup4</span> <span class="p">-</span><span class="n">-wait</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c"># 剔除 namespace</span>
<span class="p">-</span><span class="n">-exclude-namespaces</span> <span class="n">stringArray</span>                  <span class="n">namespaces</span> <span class="n">to</span> <span class="n">exclude</span> <span class="n">from</span> <span class="n">the</span> <span class="n">backup</span>

<span class="c"># 剔除资源类型</span>
<span class="p">-</span><span class="n">-exclude-resources</span> <span class="n">stringArray</span>                   <span class="n">resources</span> <span class="n">to</span> <span class="n">exclude</span> <span class="n">from</span> <span class="n">the</span> <span class="n">backup</span><span class="p">,</span> <span class="n">formatted</span> <span class="n">as</span> <span class="n">resource</span><span class="p">.</span><span class="n">group</span><span class="p">,</span> <span class="n">such</span> <span class="n">as</span> <span class="n">storageclasses</span><span class="p">.</span><span class="n">storage</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span>

<span class="c"># 包含集群资源类型 </span>
<span class="p">-</span><span class="n">-include-cluster-resources</span> <span class="n">optionalBool</span><span class="p">[=</span><span class="n">true</span><span class="p">]</span>   <span class="n">include</span> <span class="n">cluster-scoped</span> <span class="n">resources</span> <span class="k">in</span> <span class="n">the</span> <span class="n">backup</span>

<span class="c"># 包含 namespace</span>
<span class="p">-</span><span class="n">-include-namespaces</span> <span class="n">stringArray</span>                  <span class="n">namespaces</span> <span class="n">to</span> <span class="n">include</span> <span class="k">in</span> <span class="n">the</span> <span class="n">backup</span> <span class="p">(</span><span class="n">use</span> <span class="s1">&#39;*&#39;</span> <span class="k">for</span> <span class="n">all</span> <span class="n">namespaces</span><span class="p">)</span> <span class="p">(</span><span class="k">default</span> <span class="p">*)</span>

<span class="c"># 包含 namespace 资源类型</span>
<span class="p">-</span><span class="n">-include-resources</span> <span class="n">stringArray</span>                   <span class="n">resources</span> <span class="n">to</span> <span class="n">include</span> <span class="k">in</span> <span class="n">the</span> <span class="n">backup</span><span class="p">,</span> <span class="n">formatted</span> <span class="n">as</span> <span class="n">resource</span><span class="p">.</span><span class="n">group</span><span class="p">,</span> <span class="n">such</span> <span class="n">as</span> <span class="n">storageclasses</span><span class="p">.</span><span class="n">storage</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span> <span class="p">(</span><span class="n">use</span> <span class="s1">&#39;*&#39;</span> <span class="k">for</span> <span class="n">all</span> <span class="n">resources</span><span class="p">)</span>

<span class="c"># 给这个备份加上标签</span>
<span class="p">-</span><span class="n">-labels</span> <span class="n">mapStringString</span>                          <span class="n">labels</span> <span class="n">to</span> <span class="n">apply</span> <span class="n">to</span> <span class="n">the</span> <span class="n">backup</span>
<span class="n">-o</span><span class="p">,</span> <span class="p">-</span><span class="n">-output</span> <span class="n">string</span>                               <span class="n">Output</span> <span class="n">display</span> <span class="n">format</span><span class="p">.</span> <span class="k">For</span> <span class="n">create</span> <span class="n">commands</span><span class="p">,</span> <span class="n">display</span> <span class="n">the</span> <span class="n">object</span> <span class="n">but</span> <span class="k">do</span> <span class="n">not</span> <span class="n">send</span> <span class="n">it</span> <span class="n">to</span> <span class="n">the</span> <span class="n">server</span><span class="p">.</span> <span class="n">Valid</span> <span class="n">formats</span> <span class="n">are</span> <span class="s1">&#39;table&#39;</span><span class="p">,</span> <span class="s1">&#39;json&#39;</span><span class="p">,</span> <span class="n">and</span> <span class="s1">&#39;yaml&#39;</span><span class="p">.</span> <span class="s1">&#39;table&#39;</span> <span class="n">is</span> <span class="n">not</span> <span class="n">valid</span> <span class="k">for</span> <span class="n">the</span> <span class="n">install</span> <span class="n">command</span><span class="p">.</span>

<span class="c"># 对指定标签的资源进行备份</span>
<span class="n">-l</span><span class="p">,</span> <span class="p">-</span><span class="n">-selector</span> <span class="n">labelSelector</span>                      <span class="n">only</span> <span class="n">back</span> <span class="n">up</span> <span class="n">resources</span> <span class="n">matching</span> <span class="n">this</span> <span class="n">label</span> <span class="n">selector</span> <span class="p">(</span><span class="k">default</span> <span class="p">&lt;</span><span class="n">none</span><span class="p">&gt;)</span>

<span class="c"># 对 PV 创建快照</span>
<span class="p">-</span><span class="n">-snapshot-volumes</span> <span class="n">optionalBool</span><span class="p">[=</span><span class="n">true</span><span class="p">]</span>            <span class="n">take</span> <span class="n">snapshots</span> <span class="n">of</span> <span class="n">PersistentVolumes</span> <span class="n">as</span> <span class="n">part</span> <span class="n">of</span> <span class="n">the</span> <span class="n">backup</span>

<span class="c"># 指定备份的位置</span>
<span class="p">-</span><span class="n">-storage-location</span> <span class="n">string</span>                         <span class="n">location</span> <span class="k">in</span> <span class="n">which</span> <span class="n">to</span> <span class="n">store</span> <span class="n">the</span> <span class="n">backup</span>

<span class="c"># 备份数据多久删掉</span>

<span class="p">-</span><span class="n">-ttl</span> <span class="n">duration</span>                                    <span class="n">how</span> <span class="n">long</span> <span class="n">before</span> <span class="n">the</span> <span class="n">backup</span> <span class="n">can</span> <span class="n">be</span> <span class="n">garbage</span> <span class="n">collected</span> <span class="p">(</span><span class="k">default</span> <span class="n">720h0m0s</span><span class="p">)</span>

<span class="c"># 指定快照的位置，也就是哪一个公有云驱动</span>
<span class="p">-</span><span class="n">-volume-snapshot-locations</span> <span class="n">strings</span>               <span class="n">list</span> <span class="n">of</span> <span class="n">locations</span> <span class="p">(</span><span class="n">at</span> <span class="n">most</span> <span class="n">one</span> <span class="n">per</span> <span class="n">provider</span><span class="p">)</span> <span class="nb">where </span><span class="n">volume</span> <span class="n">snapshots</span> <span class="n">should</span> <span class="n">be</span> <span class="n">stored</span>
</code></pre></div>
<h1 id="velerok8s">十一、使用velero实现k8s资源对象备份<a class="headerlink" href="#velerok8s" title="Permanent link">&para;</a></h1>
<h2 id="111">11.1 创建用于备份测试应用<a class="headerlink" href="#111" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># ls velero-v1.11.0-linux-amd64</span>
<span class="n">cred-velero</span>  <span class="n">examples</span>  <span class="n">LICENSE</span>  <span class="n">velero</span>  <span class="n">velero</span><span class="p">.</span><span class="n">sh</span>


<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># ls velero-v1.11.0-linux-amd64/examples/</span>
<span class="n">minio</span>  <span class="n">nginx-app</span>


<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># ls velero-v1.11.0-linux-amd64/examples/nginx-app/</span>
<span class="n">base</span><span class="p">.</span><span class="n">yaml</span>  <span class="n">README</span><span class="p">.</span><span class="nb">md </span> <span class="n">with-pv</span><span class="p">.</span><span class="n">yaml</span>


<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># cat velero-v1.11.0-linux-amd64/examples/nginx-app/base.yaml</span>
<span class="c"># Copyright 2017 the Velero contributors.</span>
<span class="c">#</span>
<span class="c"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c"># you may not use this file except in compliance with the License.</span>
<span class="c"># You may obtain a copy of the License at</span>
<span class="c">#</span>
<span class="c">#     http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c">#</span>
<span class="c"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c"># See the License for the specific language governing permissions and</span>
<span class="c"># limitations under the License.</span>

<span class="p">---</span>
<span class="n">apiVersion</span><span class="p">:</span> <span class="n">v1</span>
<span class="n">kind</span><span class="p">:</span> <span class="n">Namespace</span>
<span class="n">metadata</span><span class="p">:</span>
  <span class="n">name</span><span class="p">:</span> <span class="n">nginx-example</span>
  <span class="n">labels</span><span class="p">:</span>
    <span class="n">app</span><span class="p">:</span> <span class="n">nginx</span>

<span class="p">---</span>
<span class="n">apiVersion</span><span class="p">:</span> <span class="n">apps</span><span class="p">/</span><span class="n">v1</span>
<span class="n">kind</span><span class="p">:</span> <span class="n">Deployment</span>
<span class="n">metadata</span><span class="p">:</span>
  <span class="n">name</span><span class="p">:</span> <span class="n">nginx-deployment</span>
  <span class="n">namespace</span><span class="p">:</span> <span class="n">nginx-example</span>
<span class="n">spec</span><span class="p">:</span>
  <span class="n">replicas</span><span class="p">:</span> <span class="n">2</span>
  <span class="n">selector</span><span class="p">:</span>
    <span class="n">matchLabels</span><span class="p">:</span>
      <span class="n">app</span><span class="p">:</span> <span class="n">nginx</span>
  <span class="n">template</span><span class="p">:</span>
    <span class="n">metadata</span><span class="p">:</span>
      <span class="n">labels</span><span class="p">:</span>
        <span class="n">app</span><span class="p">:</span> <span class="n">nginx</span>
    <span class="n">spec</span><span class="p">:</span>
      <span class="n">containers</span><span class="p">:</span>
      <span class="p">-</span> <span class="n">image</span><span class="p">:</span> <span class="n">nginx</span><span class="p">:</span><span class="n">1</span><span class="p">.</span><span class="n">17</span><span class="p">.</span><span class="n">6</span>
        <span class="n">name</span><span class="p">:</span> <span class="n">nginx</span>
        <span class="n">ports</span><span class="p">:</span>
        <span class="p">-</span> <span class="n">containerPort</span><span class="p">:</span> <span class="n">80</span>

<span class="p">---</span>
<span class="n">apiVersion</span><span class="p">:</span> <span class="n">v1</span>
<span class="n">kind</span><span class="p">:</span> <span class="n">Service</span>
<span class="n">metadata</span><span class="p">:</span>
  <span class="n">labels</span><span class="p">:</span>
    <span class="n">app</span><span class="p">:</span> <span class="n">nginx</span>
  <span class="n">name</span><span class="p">:</span> <span class="n">my-nginx</span>
  <span class="n">namespace</span><span class="p">:</span> <span class="n">nginx-example</span>
<span class="n">spec</span><span class="p">:</span>
  <span class="n">ports</span><span class="p">:</span>
  <span class="p">-</span> <span class="n">port</span><span class="p">:</span> <span class="n">80</span>
    <span class="n">targetPort</span><span class="p">:</span> <span class="n">80</span>
  <span class="n">selector</span><span class="p">:</span>
    <span class="n">app</span><span class="p">:</span> <span class="n">nginx</span>
  <span class="n">type</span><span class="p">:</span> <span class="n">LoadBalancer</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># kubectl apply -f velero-v1.11.0-linux-amd64/examples/nginx-app/base.yaml</span>
<span class="n">namespace</span><span class="p">/</span><span class="n">nginx-example</span> <span class="n">created</span>
<span class="n">deployment</span><span class="p">.</span><span class="n">apps</span><span class="p">/</span><span class="n">nginx-deployment</span> <span class="n">created</span>
<span class="n">service</span><span class="p">/</span><span class="n">my-nginx</span> <span class="n">created</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># kubectl get all -n nginx-example</span>
<span class="n">NAME</span>                                    <span class="n">READY</span>   <span class="n">STATUS</span>    <span class="n">RESTARTS</span>   <span class="n">AGE</span>
<span class="n">pod</span><span class="p">/</span><span class="n">nginx-deployment</span><span class="p">-</span><span class="n">747864f4b5</span><span class="p">-</span><span class="n">5r7kd</span>   <span class="n">1</span><span class="p">/</span><span class="n">1</span>     <span class="n">Running</span>   <span class="n">0</span>          <span class="n">39s</span>
<span class="n">pod</span><span class="p">/</span><span class="n">nginx-deployment</span><span class="p">-</span><span class="n">747864f4b5</span><span class="p">-</span><span class="n">9n5gz</span>   <span class="n">1</span><span class="p">/</span><span class="n">1</span>     <span class="n">Running</span>   <span class="n">0</span>          <span class="n">39s</span>

<span class="n">NAME</span>               <span class="nb">TYPE </span>          <span class="n">CLUSTER-IP</span>    <span class="n">EXTERNAL-IP</span>   <span class="n">PORT</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>        <span class="n">AGE</span>
<span class="n">service</span><span class="p">/</span><span class="n">my-nginx</span>   <span class="n">LoadBalancer</span>   <span class="n">10</span><span class="p">.</span><span class="n">96</span><span class="p">.</span><span class="n">1</span><span class="p">.</span><span class="n">113</span>   <span class="p">&lt;</span><span class="n">pending</span><span class="p">&gt;</span>     <span class="n">80</span><span class="p">:</span><span class="n">32403</span><span class="p">/</span><span class="n">TCP</span>   <span class="n">39s</span>

<span class="n">NAME</span>                               <span class="n">READY</span>   <span class="n">UP-TO-DATE</span>   <span class="n">AVAILABLE</span>   <span class="n">AGE</span>
<span class="n">deployment</span><span class="p">.</span><span class="n">apps</span><span class="p">/</span><span class="n">nginx-deployment</span>   <span class="n">2</span><span class="p">/</span><span class="n">2</span>     <span class="n">2</span>            <span class="n">2</span>           <span class="n">39s</span>

<span class="n">NAME</span>                                          <span class="n">DESIRED</span>   <span class="n">CURRENT</span>   <span class="n">READY</span>   <span class="n">AGE</span>
<span class="n">replicaset</span><span class="p">.</span><span class="n">apps</span><span class="p">/</span><span class="n">nginx-deployment</span><span class="p">-</span><span class="n">747864f4b5</span>   <span class="n">2</span>         <span class="n">2</span>         <span class="n">2</span>       <span class="n">39s</span>
</code></pre></div>
<h2 id="112">11.2 创建备份<a class="headerlink" href="#112" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># velero backup create nginx-backup --include-namespaces nginx-example</span>
<span class="n">Backup</span> <span class="n">request</span> <span class="s2">&quot;nginx-backup&quot;</span> <span class="n">submitted</span> <span class="n">successfully</span><span class="p">.</span>
<span class="n">Run</span> <span class="p">`</span><span class="n">velero</span> <span class="n">backup</span> <span class="n">describe</span> <span class="n">nginx-backup</span><span class="p">`</span> <span class="n">or</span> <span class="p">`</span><span class="n">velero</span> <span class="n">backup</span> <span class="n">logs</span> <span class="n">nginx-backup</span><span class="p">`</span> <span class="k">for</span> <span class="n">more</span> <span class="n">details</span><span class="p">.</span>
</code></pre></div>
<h2 id="113">11.3 查看备份<a class="headerlink" href="#113" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># velero backup describe nginx-backup</span>
<span class="n">Name</span><span class="p">:</span>         <span class="n">nginx-backup</span>
<span class="n">Namespace</span><span class="p">:</span>    <span class="n">velero</span>
<span class="n">Labels</span><span class="p">:</span>       <span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">/</span><span class="n">storage-location</span><span class="p">=</span><span class="k">default</span>
<span class="n">Annotations</span><span class="p">:</span>  <span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">/</span><span class="n">source-cluster-k8s-gitversion</span><span class="p">=</span><span class="n">v1</span><span class="p">.</span><span class="n">25</span><span class="p">.</span><span class="n">5</span>
              <span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">/</span><span class="n">source-cluster-k8s-major-version</span><span class="p">=</span><span class="n">1</span>
              <span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">/</span><span class="n">source-cluster-k8s-minor-version</span><span class="p">=</span><span class="n">25</span>

<span class="n">Phase</span><span class="p">:</span>  <span class="n">Completed</span>


<span class="n">Namespaces</span><span class="p">:</span>
  <span class="n">Included</span><span class="p">:</span>  <span class="n">nginx-example</span>
  <span class="n">Excluded</span><span class="p">:</span>  <span class="p">&lt;</span><span class="n">none</span><span class="p">&gt;</span>

<span class="n">Resources</span><span class="p">:</span>
  <span class="n">Included</span><span class="p">:</span>        <span class="p">*</span>
  <span class="n">Excluded</span><span class="p">:</span>        <span class="p">&lt;</span><span class="n">none</span><span class="p">&gt;</span>
  <span class="n">Cluster-scoped</span><span class="p">:</span>  <span class="n">auto</span>

<span class="n">Label</span> <span class="n">selector</span><span class="p">:</span>  <span class="p">&lt;</span><span class="n">none</span><span class="p">&gt;</span>

<span class="n">Storage</span> <span class="n">Location</span><span class="p">:</span>  <span class="k">default</span>

<span class="n">Velero-Native</span> <span class="n">Snapshot</span> <span class="n">PVs</span><span class="p">:</span>  <span class="n">auto</span>

<span class="n">TTL</span><span class="p">:</span>  <span class="n">720h0m0s</span>

<span class="n">CSISnapshotTimeout</span><span class="p">:</span>    <span class="n">10m0s</span>
<span class="n">ItemOperationTimeout</span><span class="p">:</span>  <span class="n">1h0m0s</span>

<span class="n">Hooks</span><span class="p">:</span>  <span class="p">&lt;</span><span class="n">none</span><span class="p">&gt;</span>

<span class="n">Backup</span> <span class="n">Format</span> <span class="n">Version</span><span class="p">:</span>  <span class="n">1</span><span class="p">.</span><span class="n">1</span><span class="p">.</span><span class="n">0</span>

<span class="n">Started</span><span class="p">:</span>    <span class="n">2023</span><span class="p">-</span><span class="n">06</span><span class="p">-</span><span class="n">08</span> <span class="n">10</span><span class="p">:</span><span class="n">49</span><span class="p">:</span><span class="n">07</span> <span class="p">+</span><span class="n">0800</span> <span class="n">CST</span>
<span class="n">Completed</span><span class="p">:</span>  <span class="n">2023</span><span class="p">-</span><span class="n">06</span><span class="p">-</span><span class="n">08</span> <span class="n">10</span><span class="p">:</span><span class="n">49</span><span class="p">:</span><span class="n">08</span> <span class="p">+</span><span class="n">0800</span> <span class="n">CST</span>

<span class="n">Expiration</span><span class="p">:</span>  <span class="n">2023</span><span class="p">-</span><span class="n">07</span><span class="p">-</span><span class="n">08</span> <span class="n">10</span><span class="p">:</span><span class="n">49</span><span class="p">:</span><span class="n">07</span> <span class="p">+</span><span class="n">0800</span> <span class="n">CST</span>

<span class="n">Velero-Native</span> <span class="n">Snapshots</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">none</span> <span class="n">included</span><span class="p">&gt;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">查看备份位置</span>
<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># velero backup-location get</span>
<span class="n">NAME</span>      <span class="n">PROVIDER</span>   <span class="n">BUCKET</span><span class="p">/</span><span class="n">PREFIX</span>   <span class="n">PHASE</span>       <span class="n">LAST</span> <span class="n">VALIDATED</span>                  <span class="n">ACCESS</span> <span class="n">MODE</span>   <span class="k">DEFAULT</span>
<span class="k">default</span>   <span class="n">aws</span>        <span class="n">velero</span>          <span class="n">Available</span>   <span class="n">2023</span><span class="p">-</span><span class="n">06</span><span class="p">-</span><span class="n">09</span> <span class="n">10</span><span class="p">:</span><span class="n">16</span><span class="p">:</span><span class="n">49</span> <span class="p">+</span><span class="n">0800</span> <span class="n">CST</span>   <span class="n">ReadWrite</span>     <span class="n">true</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">查看备份文件</span>
<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># kubectl get backups.velero.io -n velero</span>
<span class="n">NAME</span>                 <span class="n">AGE</span>
<span class="n">nginx-backup</span>         <span class="n">23h</span>
</code></pre></div>
<p><img alt="image-20230608110056263" src="../../../img/kubernetes/kubernetes_velero/image-20230608110056263.png" /></p>
<p><img alt="image-20230608110346005" src="../../../img/kubernetes/kubernetes_velero/image-20230608110346005.png" /></p>
<h1 id="velerok8s_1">十二、使用velero实现对K8S资源对象进行恢复<a class="headerlink" href="#velerok8s_1" title="Permanent link">&para;</a></h1>
<h2 id="121">12.1 删除备份测试应用<a class="headerlink" href="#121" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># kubectl delete -f velero-v1.11.0-linux-amd64/examples/nginx-app/base.yaml</span>
<span class="n">namespace</span> <span class="s2">&quot;nginx-example&quot;</span> <span class="n">deleted</span>
<span class="n">deployment</span><span class="p">.</span><span class="n">apps</span> <span class="s2">&quot;nginx-deployment&quot;</span> <span class="n">deleted</span>
<span class="n">service</span> <span class="s2">&quot;my-nginx&quot;</span> <span class="n">deleted</span>
</code></pre></div>
<h2 id="122">12.2 恢复备份测试应用<a class="headerlink" href="#122" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># velero restore create --from-backup nginx-backup --wait</span>
<span class="n">Restore</span> <span class="n">request</span> <span class="s2">&quot;nginx-backup-20230608111349&quot;</span> <span class="n">submitted</span> <span class="n">successfully</span><span class="p">.</span>
<span class="n">Waiting</span> <span class="k">for</span> <span class="n">restore</span> <span class="n">to</span> <span class="n">complete</span><span class="p">.</span> <span class="n">You</span> <span class="n">may</span> <span class="n">safely</span> <span class="n">press</span> <span class="n">ctrl-c</span> <span class="n">to</span> <span class="n">stop</span> <span class="n">waiting</span> <span class="p">-</span> <span class="n">your</span> <span class="n">restore</span> <span class="n">will</span> <span class="k">continue</span> <span class="k">in</span> <span class="n">the</span> <span class="n">background</span><span class="p">.</span>

<span class="n">Restore</span> <span class="n">completed</span> <span class="n">with</span> <span class="n">status</span><span class="p">:</span> <span class="n">Completed</span><span class="p">.</span> <span class="n">You</span> <span class="n">may</span> <span class="n">check</span> <span class="k">for</span> <span class="n">more</span> <span class="n">information</span> <span class="n">using</span> <span class="n">the</span> <span class="n">commands</span> <span class="p">`</span><span class="n">velero</span> <span class="n">restore</span> <span class="n">describe</span> <span class="n">nginx-backup</span><span class="p">-</span><span class="n">20230608111349</span><span class="p">`</span> <span class="n">and</span> <span class="p">`</span><span class="n">velero</span> <span class="n">restore</span> <span class="n">logs</span> <span class="n">nginx-backup</span><span class="p">-</span><span class="n">20230608111349</span><span class="p">`.</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># kubectl get pods -n nginx-example</span>
<span class="n">NAME</span>                                <span class="n">READY</span>   <span class="n">STATUS</span>    <span class="n">RESTARTS</span>   <span class="n">AGE</span>
<span class="n">nginx-deployment</span><span class="p">-</span><span class="n">747864f4b5</span><span class="p">-</span><span class="n">5r7kd</span>   <span class="n">1</span><span class="p">/</span><span class="n">1</span>     <span class="n">Running</span>   <span class="n">0</span>          <span class="n">37s</span>
<span class="n">nginx-deployment</span><span class="p">-</span><span class="n">747864f4b5</span><span class="p">-</span><span class="n">9n5gz</span>   <span class="n">1</span><span class="p">/</span><span class="n">1</span>     <span class="n">Running</span>   <span class="n">0</span>          <span class="n">37s</span>
</code></pre></div>
<h1 id="_1">十三、周期性备份任务<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<div class="highlight"><pre><span></span><code><span class="c"># Create a backup every 6 hours</span>
<span class="n">velero</span> <span class="n">create</span> <span class="n">schedule</span> <span class="n">NAME</span> <span class="p">-</span><span class="n">-schedule</span><span class="p">=</span><span class="s2">&quot;0 */6 * * *&quot;</span>

<span class="c"># Create a backup every 6 hours with the @every notation</span>
<span class="n">velero</span> <span class="n">create</span> <span class="n">schedule</span> <span class="n">NAME</span> <span class="p">-</span><span class="n">-schedule</span><span class="p">=</span><span class="s2">&quot;@every 6h&quot;</span>

<span class="c"># Create a daily backup of the web namespace</span>
<span class="n">velero</span> <span class="n">create</span> <span class="n">schedule</span> <span class="n">NAME</span> <span class="p">-</span><span class="n">-schedule</span><span class="p">=</span><span class="s2">&quot;@every 24h&quot;</span> <span class="p">-</span><span class="n">-include-namespaces</span> <span class="n">web</span>

<span class="c"># Create a weekly backup, each living for 90 days (2160 hours)</span>
<span class="n">velero</span> <span class="n">create</span> <span class="n">schedule</span> <span class="n">NAME</span> <span class="p">-</span><span class="n">-schedule</span><span class="p">=</span><span class="s2">&quot;@every 168h&quot;</span> <span class="p">-</span><span class="n">-ttl</span> <span class="n">2160h0m0s</span>


<span class="c"># 每日对anchnet-devops-dev/anchnet-devops-test/anchnet-devops-prod/xxxxx-devops-common-test 名称空间进行备份</span>
<span class="n">velero</span> <span class="n">create</span> <span class="n">schedule</span> <span class="n">anchnet-devops-dev</span> <span class="p">-</span><span class="n">-schedule</span><span class="p">=</span><span class="s2">&quot;@every 24h&quot;</span> <span class="p">-</span><span class="n">-include-namespaces</span> <span class="n">xxxxx-devops-dev</span> 
<span class="n">velero</span> <span class="n">create</span> <span class="n">schedule</span> <span class="n">anchnet-devops-test</span> <span class="p">-</span><span class="n">-schedule</span><span class="p">=</span><span class="s2">&quot;@every 24h&quot;</span> <span class="p">-</span><span class="n">-include-namespaces</span> <span class="n">xxxxx-devops-test</span>
<span class="n">velero</span> <span class="n">create</span> <span class="n">schedule</span> <span class="n">anchnet-devops-prod</span> <span class="p">-</span><span class="n">-schedule</span><span class="p">=</span><span class="s2">&quot;@every 24h&quot;</span> <span class="p">-</span><span class="n">-include-namespaces</span> <span class="n">xxxxx-devops-prod</span> 
<span class="n">velero</span> <span class="n">create</span> <span class="n">schedule</span> <span class="n">anchnet-devops-common-test</span> <span class="p">-</span><span class="n">-schedule</span><span class="p">=</span><span class="s2">&quot;@every 24h&quot;</span> <span class="p">-</span><span class="n">-include-namespaces</span> <span class="n">xxxxx-devops-common-test</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">案例</span><span class="err">：</span>
<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># velero create schedule nginx-backups --schedule=&quot;0 */1 * * *&quot; --include-namespaces nginx-example</span>
<span class="n">Schedule</span> <span class="s2">&quot;nginx-backups&quot;</span> <span class="n">created</span> <span class="n">successfully</span><span class="p">.</span>

<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># velero get schedules</span>
<span class="n">NAME</span>            <span class="n">STATUS</span>    <span class="n">CREATED</span>                         <span class="n">SCHEDULE</span>      <span class="n">BACKUP</span> <span class="n">TTL</span>   <span class="n">LAST</span> <span class="n">BACKUP</span>   <span class="n">SELECTOR</span>   <span class="n">PAUSED</span>
<span class="n">nginx-backups</span>   <span class="n">Enabled</span>   <span class="n">2023</span><span class="p">-</span><span class="n">06</span><span class="p">-</span><span class="n">09</span> <span class="n">10</span><span class="p">:</span><span class="n">36</span><span class="p">:</span><span class="n">08</span> <span class="p">+</span><span class="n">0800</span> <span class="n">CST</span>   <span class="n">0</span> <span class="p">*/</span><span class="n">1</span> <span class="p">*</span> <span class="p">*</span> <span class="p">*</span>   <span class="n">0s</span>           <span class="n">n</span><span class="p">/</span><span class="n">a</span>           <span class="p">&lt;</span><span class="n">none</span><span class="p">&gt;</span>     <span class="n">false</span>
</code></pre></div>
<blockquote>
<p>注意事项：</p>
<ul>
<li>在velero备份的时候，备份过程中创建的对象是不会被备份的。</li>
<li>velero restore 恢复不会覆盖已有的资源，只恢复当前集群中不存在的资源。已有的资源不会回滚到之前的版本，如需要回滚，需在restore之前提前删除现有的资源。</li>
<li>velero也可作为一个crontjob来运行，定期备份数据。</li>
</ul>
</blockquote>
<h1 id="k8svelero">十四、在其它K8S集群中部署velero及恢复应用<a class="headerlink" href="#k8svelero" title="Permanent link">&para;</a></h1>
<h2 id="141_k8svelero">14.1 在其它K8S集群中部署velero<a class="headerlink" href="#141_k8svelero" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="n">从第一个K8S集群中复制文件到第二个K8S集群master节点</span>
<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># scp -r velero-v1.11.0-linux-amd64 192.168.10.160:/root</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># cp velero-v1.11.0-linux-amd64/velero /usr/bin/</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">velero-v1</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">0-linux-amd64</span><span class="p">]</span><span class="c"># cat cred-velero</span>
<span class="no">[default]</span>
<span class="n">aws_access_key_id</span> <span class="p">=</span> <span class="n">minio</span>
<span class="n">aws_secret_access_key</span> <span class="p">=</span> <span class="n">minio123</span>


<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">velero-v1</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">0-linux-amd64</span><span class="p">]</span><span class="c"># cat velero.sh</span>
<span class="n">velero</span> <span class="n">install</span> <span class="p">\</span>
     <span class="p">-</span><span class="n">-provider</span> <span class="n">aws</span> <span class="p">\</span>
     <span class="p">-</span><span class="n">-plugins</span> <span class="n">velero</span><span class="p">/</span><span class="n">velero-plugin-for-aws</span><span class="p">:</span><span class="n">v1</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span> <span class="p">\</span>
     <span class="p">-</span><span class="n">-bucket</span> <span class="n">velero</span> <span class="p">\</span>
     <span class="p">-</span><span class="n">-secret</span><span class="o">-file</span> <span class="p">./</span><span class="n">cred-velero</span> <span class="p">\</span>
     <span class="p">-</span><span class="n">-use-volume-snapshots</span><span class="p">=</span><span class="n">false</span> <span class="p">\</span>
     <span class="p">-</span><span class="n">-backup-location-config</span> <span class="n">region</span><span class="p">=</span><span class="n">minio</span><span class="p">,</span><span class="n">s3ForcePathStyle</span><span class="p">=</span><span class="s2">&quot;true&quot;</span><span class="p">,</span><span class="n">s3Url</span><span class="p">=</span><span class="n">http</span><span class="p">://</span><span class="n">minio</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">svc</span><span class="p">.</span><span class="n">cluster</span><span class="p">.</span><span class="n">local</span><span class="p">.:</span><span class="n">9000</span>


<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">velero-v1</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">0-linux-amd64</span><span class="p">]</span><span class="c"># vim velero.sh</span>
<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">velero-v1</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">0-linux-amd64</span><span class="p">]</span><span class="c"># cat velero.sh</span>
<span class="n">velero</span> <span class="n">install</span> <span class="p">\</span>
     <span class="p">-</span><span class="n">-provider</span> <span class="n">aws</span> <span class="p">\</span>
     <span class="p">-</span><span class="n">-plugins</span> <span class="n">velero</span><span class="p">/</span><span class="n">velero-plugin-for-aws</span><span class="p">:</span><span class="n">v1</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span> <span class="p">\</span>
     <span class="p">-</span><span class="n">-bucket</span> <span class="n">velero</span> <span class="p">\</span>
     <span class="p">-</span><span class="n">-secret</span><span class="o">-file</span> <span class="p">./</span><span class="n">cred-velero</span> <span class="p">\</span>
     <span class="p">-</span><span class="n">-use-volume-snapshots</span><span class="p">=</span><span class="n">false</span> <span class="p">\</span>
     <span class="p">-</span><span class="n">-backup-location-config</span> <span class="n">region</span><span class="p">=</span><span class="n">minio</span><span class="p">,</span><span class="n">s3ForcePathStyle</span><span class="p">=</span><span class="s2">&quot;true&quot;</span><span class="p">,</span><span class="n">s3Url</span><span class="p">=</span><span class="n">http</span><span class="p">://</span><span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">10</span><span class="p">.</span><span class="n">140</span><span class="p">:</span><span class="n">31900</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">velero-v1</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">0-linux-amd64</span><span class="p">]</span><span class="c"># sh velero.sh</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">backuprepositories</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">backuprepositories</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">backuprepositories</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">created</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">backups</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">backups</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">backups</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">created</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">backupstoragelocations</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">backupstoragelocations</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">backupstoragelocations</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">created</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">deletebackuprequests</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">deletebackuprequests</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">deletebackuprequests</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">created</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">downloadrequests</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">downloadrequests</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">downloadrequests</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">created</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">podvolumebackups</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">podvolumebackups</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">podvolumebackups</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">created</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">podvolumerestores</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">podvolumerestores</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">podvolumerestores</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">created</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">restores</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">restores</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">restores</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">created</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">schedules</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">schedules</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">schedules</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">created</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">serverstatusrequests</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">serverstatusrequests</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">serverstatusrequests</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">created</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">volumesnapshotlocations</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">volumesnapshotlocations</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">CustomResourceDefinition</span><span class="p">/</span><span class="n">volumesnapshotlocations</span><span class="p">.</span><span class="n">velero</span><span class="p">.</span><span class="n">io</span><span class="p">:</span> <span class="n">created</span>
<span class="n">Waiting</span> <span class="k">for</span> <span class="n">resources</span> <span class="n">to</span> <span class="n">be</span> <span class="n">ready</span> <span class="k">in</span> <span class="n">cluster</span><span class="p">...</span>
<span class="n">Namespace</span><span class="p">/</span><span class="n">velero</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">Namespace</span><span class="p">/</span><span class="n">velero</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">Namespace</span><span class="p">/</span><span class="n">velero</span><span class="p">:</span> <span class="n">already</span> <span class="n">exists</span><span class="p">,</span> <span class="n">proceeding</span>
<span class="n">Namespace</span><span class="p">/</span><span class="n">velero</span><span class="p">:</span> <span class="n">created</span>
<span class="n">ClusterRoleBinding</span><span class="p">/</span><span class="n">velero</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">ClusterRoleBinding</span><span class="p">/</span><span class="n">velero</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">ClusterRoleBinding</span><span class="p">/</span><span class="n">velero</span><span class="p">:</span> <span class="n">created</span>
<span class="n">ServiceAccount</span><span class="p">/</span><span class="n">velero</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">ServiceAccount</span><span class="p">/</span><span class="n">velero</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">ServiceAccount</span><span class="p">/</span><span class="n">velero</span><span class="p">:</span> <span class="n">created</span>
<span class="n">Secret</span><span class="p">/</span><span class="n">cloud-credentials</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">Secret</span><span class="p">/</span><span class="n">cloud-credentials</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">Secret</span><span class="p">/</span><span class="n">cloud-credentials</span><span class="p">:</span> <span class="n">created</span>
<span class="n">BackupStorageLocation</span><span class="p">/</span><span class="k">default</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">BackupStorageLocation</span><span class="p">/</span><span class="k">default</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">BackupStorageLocation</span><span class="p">/</span><span class="k">default</span><span class="p">:</span> <span class="n">created</span>
<span class="n">Deployment</span><span class="p">/</span><span class="n">velero</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span>
<span class="n">Deployment</span><span class="p">/</span><span class="n">velero</span><span class="p">:</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span> <span class="n">resource</span> <span class="n">client</span>
<span class="n">Deployment</span><span class="p">/</span><span class="n">velero</span><span class="p">:</span> <span class="n">created</span>
<span class="n">Velero</span> <span class="n">is</span> <span class="n">installed</span><span class="p">!</span> <span class="err">⛵</span> <span class="n">Use</span> <span class="s1">&#39;kubectl logs deployment/velero -n velero&#39;</span> <span class="n">to</span> <span class="n">view</span> <span class="n">the</span> <span class="n">status</span><span class="p">.</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">velero-v1</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">0-linux-amd64</span><span class="p">]</span><span class="c"># kubectl get pods -n velero</span>
<span class="n">NAME</span>                      <span class="n">READY</span>   <span class="n">STATUS</span>      <span class="n">RESTARTS</span>   <span class="n">AGE</span>
<span class="n">velero</span><span class="p">-</span><span class="n">84fff5d559-x82gh</span>   <span class="n">1</span><span class="p">/</span><span class="n">1</span>     <span class="n">Running</span>     <span class="n">0</span>          <span class="n">50s</span>
</code></pre></div>
<h2 id="142_k8s">14.2 恢复应用到新K8S集群<a class="headerlink" href="#142_k8s" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="n">查看备份位置</span> 
<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">velero-v1</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">0-linux-amd64</span><span class="p">]</span><span class="c"># velero backup-location get</span>
<span class="n">NAME</span>      <span class="n">PROVIDER</span>   <span class="n">BUCKET</span><span class="p">/</span><span class="n">PREFIX</span>   <span class="n">PHASE</span>       <span class="n">LAST</span> <span class="n">VALIDATED</span>                  <span class="n">ACCESS</span> <span class="n">MODE</span>   <span class="k">DEFAULT</span>
<span class="k">default</span>   <span class="n">aws</span>        <span class="n">velero</span>          <span class="n">Available</span>   <span class="n">2023</span><span class="p">-</span><span class="n">06</span><span class="p">-</span><span class="n">09</span> <span class="n">10</span><span class="p">:</span><span class="n">16</span><span class="p">:</span><span class="n">44</span> <span class="p">+</span><span class="n">0800</span> <span class="n">CST</span>   <span class="n">ReadWrite</span>     <span class="n">true</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">查看备份文件</span>
<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="n">velero-v1</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">0-linux-amd64</span><span class="p">]</span><span class="c"># kubectl get backups.velero.io -n velero</span>
<span class="n">NAME</span>                 <span class="n">AGE</span>
<span class="n">nginx-backup</span>         <span class="n">4m7s</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">恢复备份到新K8S集群</span>
<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># velero restore create \</span>
<span class="p">-</span><span class="n">-namespace</span> <span class="n">velero</span> <span class="p">\</span>
<span class="p">-</span><span class="n">-from-backup</span> <span class="n">nginx-backup</span> <span class="p">-</span><span class="n">-wait</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">查看备份恢复情况</span>
<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># kubectl get ns</span>
<span class="n">NAME</span>               <span class="n">STATUS</span>   <span class="n">AGE</span>
<span class="n">calico-apiserver</span>   <span class="n">Active</span>   <span class="n">56d</span>
<span class="n">calico-system</span>      <span class="n">Active</span>   <span class="n">56d</span>
<span class="k">default</span>            <span class="n">Active</span>   <span class="n">56d</span>
<span class="n">kube-node-lease</span>    <span class="n">Active</span>   <span class="n">56d</span>
<span class="n">kube-public</span>        <span class="n">Active</span>   <span class="n">56d</span>
<span class="n">kube-system</span>        <span class="n">Active</span>   <span class="n">56d</span>
<span class="n">nginx-example</span>      <span class="n">Active</span>   <span class="n">7s</span>
<span class="n">tigera-operator</span>    <span class="n">Active</span>   <span class="n">56d</span>
<span class="n">velero</span>             <span class="n">Active</span>   <span class="n">6m17s</span>


<span class="p">[</span><span class="n">root</span><span class="nv">@k8s</span><span class="n">-master01</span> <span class="p">~]</span><span class="c"># kubectl get pods -n nginx-example</span>
<span class="n">NAME</span>                                <span class="n">READY</span>   <span class="n">STATUS</span>    <span class="n">RESTARTS</span>   <span class="n">AGE</span>
<span class="n">nginx-deployment</span><span class="p">-</span><span class="n">747864f4b5</span><span class="p">-</span><span class="n">5r7kd</span>   <span class="n">1</span><span class="p">/</span><span class="n">1</span>     <span class="n">Running</span>   <span class="n">0</span>          <span class="n">22s</span>
<span class="n">nginx-deployment</span><span class="p">-</span><span class="n">747864f4b5</span><span class="p">-</span><span class="n">9n5gz</span>   <span class="n">1</span><span class="p">/</span><span class="n">1</span>     <span class="n">Running</span>   <span class="n">0</span>          <span class="n">22s</span>
</code></pre></div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      BurningMyself<a href='https://beian.miit.gov.cn/' target='_blank'>  蜀ICP备15033200号-1</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/burningmyself" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://gitee.com/burningmyself" target="_blank" rel="noopener" title="gitee.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 488 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2 0 256S110.8 8 248 8c66.8 0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2 0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.2a6f1dda.min.js"></script>
      
        <script src="../../../js/extra.js"></script>
      
        <script src="../../../js/baidu-tongji.js"></script>
      
        <script src="https://www.googletagmanager.com/gtag/js?id=UA-155084439-1"></script>
      
        <script src="https://www.googletagmanager.com/gtag/js?id=UA-155132293-1"></script>
      
        <script src="../../../js/google.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>